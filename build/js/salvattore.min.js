/*! mercury - v0.1.0 - 2015-06-29
    Copyright 2015 Palantir */
!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("salvattore",[],b):a.salvattore=b()}(this,function(){window.matchMedia||(window.matchMedia=function(){"use strict";var a=window.styleMedia||window.media;if(!a){var b=document.createElement("style"),c=document.getElementsByTagName("script")[0],d=null;b.type="text/css",b.id="matchmediajs-test",c.parentNode.insertBefore(b,c),d="getComputedStyle"in window&&window.getComputedStyle(b,null)||b.currentStyle,a={matchMedium:function(a){var c="@media "+a+"{ #matchmediajs-test { width: 1px; } }";return b.styleSheet?b.styleSheet.cssText=c:b.textContent=c,"1px"===d.width}}}return function(b){return{matches:a.matchMedium(b||"all"),media:b||"all"}}}()),function(){if(window.matchMedia&&window.matchMedia("all").addListener)return!1;var a=window.matchMedia,b=a("only all").matches,c=!1,d=0,e=[],f=function(b){clearTimeout(d),d=setTimeout(function(){for(var b=0,c=e.length;c>b;b++){var d=e[b].mql,f=e[b].listeners||[],g=a(d.media).matches;if(g!==d.matches){d.matches=g;for(var h=0,i=f.length;i>h;h++)f[h].call(window,d)}}},30)};window.matchMedia=function(d){var g=a(d),h=[],i=0;return g.addListener=function(a){b&&(c||(c=!0,window.addEventListener("resize",f,!0)),0===i&&(i=e.push({mql:g,listeners:h})),h.push(a))},g.removeListener=function(a){for(var b=0,c=h.length;c>b;b++)h[b]===a&&h.splice(b,1)},g}}(),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var a=function(a,b,c){"use strict";var d={},e=[],f=function(a,b,c){a.dataset?a.dataset[b]=c:a.setAttribute("data-"+b,c)};return d.obtain_grid_settings=function(b){var c,d,e=a.getComputedStyle(b,":before"),f=e.getPropertyValue("content").slice(1,-1),g=f.match(/^\s*(\d+)(?:\s?\.(.+))?\s*$/);return g?(c=g[1],d=g[2],d=d?d.split("."):["column"]):(g=f.match(/^\s*\.(.+)\s+(\d+)\s*$/),d=g[1],c=g[2],c&&(c=c.split("."))),{numberOfColumns:c,columnClasses:d}},d.add_columns=function(a,c){for(var e,g=d.obtain_grid_settings(a),h=g.numberOfColumns,i=g.columnClasses,j=new Array(+h),k=b.createDocumentFragment(),l=h;0!==l--;)e="[data-columns] > *:nth-child("+h+"n-"+l+")",j.push(c.querySelectorAll(e));j.forEach(function(a){var c=b.createElement("div"),d=b.createDocumentFragment();c.className=i.join(" "),Array.prototype.forEach.call(a,function(a){d.appendChild(a)}),c.appendChild(d),k.appendChild(c)}),a.appendChild(k),f(a,"columns",h)},d.remove_columns=function(c){var d=b.createRange();d.selectNodeContents(c);var e=Array.prototype.filter.call(d.extractContents().childNodes,function(b){return b instanceof a.HTMLElement}),g=e.length,h=e[0].childNodes.length,i=new Array(h*g);Array.prototype.forEach.call(e,function(a,b){Array.prototype.forEach.call(a.children,function(a,c){i[c*g+b]=a})});var j=b.createElement("div");return f(j,"columns",0),i.filter(function(a){return!!a}).forEach(function(a){j.appendChild(a)}),j},d.recreate_columns=function(b){a.requestAnimationFrame(function(){d.add_columns(b,d.remove_columns(b))})},d.media_query_change=function(a){a.matches&&Array.prototype.forEach.call(e,d.recreate_columns)},d.get_css_rules=function(a){var b;try{b=a.sheet.cssRules||a.sheet.rules}catch(c){return[]}return b||[]},d.get_stylesheets=function(){return Array.prototype.concat.call(Array.prototype.slice.call(b.querySelectorAll("style[type='text/css']")),Array.prototype.slice.call(b.querySelectorAll("link[rel='stylesheet']")))},d.media_rule_has_columns_selector=function(a){for(var b,c=a.length;c--;)if(b=a[c],b.selectorText&&b.selectorText.match(/\[data-columns\](.*)::?before$/))return!0;return!1},d.scan_media_queries=function(){var b=[];a.matchMedia&&(d.get_stylesheets().forEach(function(c){Array.prototype.forEach.call(d.get_css_rules(c),function(c){c.media&&d.media_rule_has_columns_selector(c.cssRules)&&b.push(a.matchMedia(c.media.mediaText))})}),b.forEach(function(a){a.addListener(d.media_query_change)}))},d.next_element_column_index=function(a,b){var c,d,e,f=a.children,g=f.length,h=0,i=0;for(e=0;g>e;e++)c=f[e],d=c.children.length+b[e].children.length,0===h&&(h=d),h>d&&(i=e,h=d);return i},d.create_list_of_fragments=function(a){for(var c=new Array(a),d=0;d!==a;)c[d]=b.createDocumentFragment(),d++;return c},d.append_elements=function(a,b){var c=a.children,e=c.length,f=d.create_list_of_fragments(e);b.forEach(function(b){var c=d.next_element_column_index(a,f);f[c].appendChild(b)}),Array.prototype.forEach.call(c,function(a,b){a.appendChild(f[b])})},d.prepend_elements=function(a,c){var e=a.children,f=e.length,g=d.create_list_of_fragments(f),h=f-1;c.forEach(function(a){var b=g[h];b.insertBefore(a,b.firstChild),0===h?h=f-1:h--}),Array.prototype.forEach.call(e,function(a,b){a.insertBefore(g[b],a.firstChild)});for(var i=b.createDocumentFragment(),j=c.length%f;0!==j--;)i.appendChild(a.lastChild);a.insertBefore(i,a.firstChild)},d.register_grid=function(c){if("none"!==a.getComputedStyle(c).display){var g=b.createRange();g.selectNodeContents(c);var h=b.createElement("div");h.appendChild(g.extractContents()),f(h,"columns",0),d.add_columns(c,h),e.push(c)}},d.init=function(){var a=b.createElement("style");a.innerHTML="[data-columns]::before{visibility:hidden;position:absolute;font-size:1px;}",b.head.appendChild(a);var c=b.querySelectorAll("[data-columns]");Array.prototype.forEach.call(c,d.register_grid),d.scan_media_queries()},d.init(),{append_elements:d.append_elements,prepend_elements:d.prepend_elements,register_grid:d.register_grid}}(window,window.document);return a});
//# sourceMappingURL=salvattore.min.js.map